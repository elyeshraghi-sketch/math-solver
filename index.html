<!DOCTYPE html>
<html lang="fa" dir="rtl" style="height:100%">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ø¹Ø±ÙØ§Ù† Ø­ÛŒØ¯Ø±ÛŒ Ø­Ù„â€ŒÚ©Ù†Ù†Ø¯Ù‡Ù” Ù‡Ù…Ù‡â€ŒÚ†ÛŒØ² Ø±ÛŒØ§Ø¶ÛŒ</title>
  <script src="https://unpkg.com/mathjs@12.4.2/lib/browser/math.js"></script>
  <style>
    *{box-sizing:border-box}body{font-family:Vazir,Tahoma,sans-serif;background:#f8f9ff;margin:0;padding:15px;height:100%}
    .container{max-width:700px;margin:0 auto}header{text-align:center;padding:20px 0}
    h1{color:#2c3e50}input{width:100%;padding:16px;font-size:18px;border:2px solid #ccc;border-radius:10px;margin:15px 0;direction:ltr;text-align:left}
    button{background:#3498db;color:#fff;border:none;padding:14px 24px;font-size:18px;border-radius:10px;cursor:pointer;width:100%}
    #out{background:#fff;padding:20px;border-radius:10px;margin-top:20px;min-height:60px;overflow:auto}
    .ex{margin-top:20px;font-size:14px;color:#777}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ§  Ø­Ù„â€ŒÚ©Ù†Ù†Ø¯Ù‡Ù” Ø¬Ø§Ù…Ø¹ Ø±ÛŒØ§Ø¶ÛŒ</h1>
      <p>Ù‡Ù…Ù‡ Ú†ÛŒØ² Ø§Ø² <code>2+3</code> ØªØ§ <code>integrate(x^2,x)</code></p>
    </header>
    <input id="in" placeholder="Ù…Ø«Ø§Ù„: 5^2, solve(x^2=4), plot sin(x)" value="2+3*4">
    <button onclick="go()">âš¡ Ø­Ù„ Ú©Ù†</button>
    <div id="out">Ù†ØªÛŒØ¬Ù‡ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯...</div>
    <div class="ex">
      âœ… Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø²: Ø¬Ù…Ø¹/Ø¶Ø±Ø¨/ØªÙˆØ§Ù† (`5^3`)ØŒ ÙØ§Ú©ØªÙˆØ±ÛŒÙ„ (`5!`)ØŒ Ø±ÛŒØ´Ù‡ (`sqrt(16)`)ØŒ Ù„Ú¯ (`log(100)`)ØŒ Ù…Ø«Ù„Ø«Ø§Øª (`sin(pi/2)`)ØŒ Ù…Ø¹Ø§Ø¯Ù„Ù‡ (`x+2=5`)ØŒ Ø§Ù†ØªÚ¯Ø±Ø§Ù„ (`integrate(x^2,x)`)ØŒ Ù…Ø§ØªØ±ÛŒØ³ Ùˆ...
    </div>
  </div>
  <script>
    const math = window.math;
    function go(){
      const q = document.getElementById('in').value.trim();
      const out = document.getElementById('out');
      if(!q){ out.innerHTML='âŒ Ù„Ø·ÙØ§Ù‹ Ø¹Ø¨Ø§Ø±ØªÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.'; return; }
      try {
        let res;
        if(q.startsWith('plot ') || q.startsWith('graph ')){
          out.innerHTML='âš ï¸ Ø±Ø³Ù… Ù†Ù…ÙˆØ¯Ø§Ø± Ø¯Ø± Ø§ÛŒÙ† Ù†Ø³Ø®Ù‡ Ø³Ø¨Ú© ØºÛŒØ±ÙØ¹Ø§Ù„ Ø§Ø³Øª. Ø¨Ø±Ø§ÛŒ Ø±Ø³Ù…ØŒ Ø§Ø² Ù†Ø³Ø®Ù‡Ù” Ú©Ø§Ù…Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.';
          return;
        } else if(q.includes('=')){
          const [l,r] = q.split('=').map(x=>x.trim());
          const eq = `${l} - (${r})`;
          res = math.solve(math.parse(eq), 'x');
          res = Array.isArray(res) ? res.map(r=>r.toNumber ? r.toNumber() : r.toString()).join(', ') : res.toString();
        } else {
          // Ù¾ÛŒØ´â€ŒÙ¾Ø±Ø¯Ø§Ø²Ø´: int â†’ integrate, diff â†’ derivative, ln â†’ log
          let expr = q.replace(/\bint\b/g,'integrate').replace(/\bdiff\b/g,'derivative').replace(/\bln\b/g,'log');
          if(expr.includes('!') && !expr.includes('factorial')){
            expr = expr.replace(/(\d+)!/g, 'factorial($1)');
          }
          res = math.evaluate(expr);
        }
        out.innerHTML = `<strong style="color:#27ae60">âœ… Ù¾Ø§Ø³Ø®:</strong> <code>${math.format(res, {precision:12})}</code>`;
      } catch(e){
        out.innerHTML = `âŒ Ø®Ø·Ø§: ${e.message || 'Ø¹Ø¨Ø§Ø±Øª Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª.'}`;
      }
    }
    window.onload = go;
  </script>
</body>
</html>
